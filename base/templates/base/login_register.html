{% extends 'main.html' %}

{% load static %}

{% block content %}

{% if page == 'login' %}

<div class="form-login">
    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }}" style="color: #dc3545; margin-bottom: 20px; padding: 10px; border: 1px solid #f5c6cb; border-radius: 4px; background-color: #f8d7da;">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}
    
    <form method="POST" action="" data-recaptcha="true" data-recaptcha-key="{{ RECAPTCHA_PUBLIC_KEY }}">
        {% csrf_token %}
        {{ form.captcha }}

        {% if form.non_field_errors %}
            <div class="alert alert-danger" style="color: #dc3545; margin-bottom: 20px; padding: 10px; border: 1px solid #f5c6cb; border-radius: 4px; background-color: #f8d7da;">
                {% for error in form.non_field_errors %}
                    {{ error }}
                {% endfor %}
            </div>
        {% endif %}

        <div class="form-login-single">
            <div>
                <h5><label>Email:</label></h5>
            </div>
            <input type="text" name="email" placeholder="Email" value="{{ form.email.value|default:'' }}" {% if form.email.errors %}style="border-color: #dc3545;"{% endif %}/>
            {% if form.email.errors %}
                <div style="color: #dc3545; font-size: 0.875em; margin-top: 5px;">
                    {{ form.email.errors.0 }}
                </div>
            {% endif %}
        </div>
        <div class="form-login-single">
            <div>
                <h5><label>Password:</label></h5>
            </div>
            <input type="password" name="password" placeholder="Password" {% if form.password.errors %}style="border-color: #dc3545;"{% endif %}/>
            {% if form.password.errors %}
                <div style="color: #dc3545; font-size: 0.875em; margin-top: 5px;">
                    {{ form.password.errors.0 }}
                </div>
            {% endif %}
        </div>
        <input type="submit" value="Login"/>
    </form>
</div>

<center>
    <p>
        Don't have an account? <a href="{% url 'register' %}"><b>Sign up</b></a>
    </p>
    <p>
        Forgotten your password?  <a href="{% url 'reset_password' %}"><b>Reset password</b></a>
    </p>
</center>
{% else %}

<div class="form-register">
    <form method="POST" action="" data-recaptcha="true" data-recaptcha-key="{{ RECAPTCHA_PUBLIC_KEY }}">
        {% csrf_token %}
        {{ form.captcha }}

        <center>
            <div class="form-register-single">
                <div>
                    <h5><label>Username:</label></h5>
                </div>
                <input type="text" name="username" placeholder="Username"/>
            </div>
            <div class="form-register-single">
                <div>
                    <h5><label>Email:</label></h5>
                </div>
                <input type="text" name="email" placeholder="Email"/>
            </div>
        </center>
        <div class="form-register-single">
            <center>
                <div>
                    <h5><label>Password:</label></h5>
                </div>
                <input type="password" name="password" id="id_password" placeholder="Password"/>
            </center>
            <ul id="password-rules" class="password-rules">
                <li data-rule="length">min. 9 characters</li>
                <li data-rule="upper">at least 1 uppercase letter (A–Z)</li>
                <li data-rule="lower">at least 1 lowercase letter (a–z)</li>
                <li data-rule="digit">at least 1 digit (0–9)</li>
                <li data-rule="symbol">at least 1 special character (! @ # ...)</li>
            </ul>
        </div>
        <center>
            <div class="form-register-single">
                <div>
                    <h5><label>Password confirmation:</label></h5>
                </div>
                <input type="password" name="password_confirm" placeholder="Password"/>
            </div>
        </center>
        <input type="submit" value="Register"/>
    </form>
</div>

<center>
    <p>
    Already have an account? <a href="{% url 'login' %}"><b>Log in</b></a>
    </p>
</center>

{% endif %}

<script src="https://www.google.com/recaptcha/api.js?render={{ RECAPTCHA_PUBLIC_KEY }}" async defer></script>
<script src="{% static 'js/recaptcha.js' %}"></script>
<script src="{% static 'js/pass_validation.js' %}"></script>

{% endblock content %}